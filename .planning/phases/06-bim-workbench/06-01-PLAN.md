---
phase: 06-bim-workbench
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/Layout/icons/CubeIcon.jsx
  - frontend/src/components/Layout/icons/BuildingIcon.jsx
  - frontend/src/components/Layout/icons/DoorIcon.jsx
  - frontend/src/components/Layout/icons/TextIcon.jsx
  - frontend/src/components/Layout/icons/EditIcon.jsx
  - frontend/src/components/Layout/icons/SettingsIcon.jsx
  - frontend/src/components/Layout/icons/DownloadIcon.jsx
  - frontend/src/components/Layout/icons/index.js
  - frontend/src/components/Layout/BIMHeader.jsx
  - frontend/src/components/Layout/BIMStatusBar.jsx
  - frontend/src/components/Layout/QuickActions.jsx
  - frontend/src/components/Layout/BIMLayout.jsx
autonomous: true

must_haves:
  truths:
    - All 8 icon components render without errors
    - BIMLayout.jsx imports all icons correctly
    - BIMHeader displays with undo/redo, view modes, project controls
    - BIMStatusBar shows tool info, coordinates, zoom, snap status
    - QuickActions has New, Save, Export buttons
    - createProject function is properly wired in QuickActions
  artifacts:
    - path: frontend/src/components/Layout/icons/index.js
      provides: Barrel export for all icons
      exports: [CubeIcon, BuildingIcon, DoorIcon, TextIcon, EditIcon, SettingsIcon, DownloadIcon, PencilIcon]
    - path: frontend/src/components/Layout/BIMHeader.jsx
      provides: Header with project controls and view modes
      exports: [BIMHeader]
    - path: frontend/src/components/Layout/BIMStatusBar.jsx
      provides: Status bar with coordinate and zoom info
      exports: [BIMStatusBar]
    - path: frontend/src/components/Layout/QuickActions.jsx
      provides: Quick action buttons
      exports: [QuickActions]
    - path: frontend/src/components/Layout/BIMLayout.jsx
      provides: Main layout integrating all components
  key_links:
    - from: BIMLayout.jsx
      to: useBIMStore
      via: createProject action
      pattern: const { createProject } = useBIMStore()
    - from: QuickActions
      to: useBIMStore
      via: createProject, saveProject
---

<objective>
Set up the complete project structure and routing for the BIM workbench, including all icon components missing from BIMLayout.jsx and layout sub-components.

Purpose: Establish the visual foundation for the BIM workbench so users can navigate between tool categories and access quick actions.
Output: Working BIM layout with all icons, header, status bar, and sub-components rendering correctly.
</objective>

<execution_context>
@/home/tomas/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/tomas/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@frontend/src/components/Layout/BIMLayout.jsx
@frontend/src/stores/useBIMStore.ts
@frontend/src/components/Layout/icons/PencilIcon.jsx

## Current State

BIMLayout.jsx exists and references 8 icon components:
- PencilIcon (exists but SVG is corrupted)
- CubeIcon (missing - for 3D modeling)
- BuildingIcon (missing - for structural)
- DoorIcon (missing - for building elements)
- TextIcon (missing - for annotations)
- EditIcon (missing - for modify tools)
- SettingsIcon (missing - for manage tools)
- DownloadIcon (missing - for export)

The layout has 8 tool categories: 2d-drafting, 3d-modeling, structural, building-elements, annotations, modify, manage, export.

BIMLayout.jsx has a bug on line 258: it references `createProject` but never imports it from useBIMStore.

useBIMStore.ts provides createProject(name: string) action that creates a new BIM project with UUID.
</context>

<tasks>

<task type="auto">
  <name>Create all missing icon components</name>
  <files>
    frontend/src/components/Layout/icons/CubeIcon.jsx
    frontend/src/components/Layout/icons/BuildingIcon.jsx
    frontend/src/components/Layout/icons/DoorIcon.jsx
    frontend/src/components/Layout/icons/TextIcon.jsx
    frontend/src/components/Layout/icons/EditIcon.jsx
    frontend/src/components/Layout/icons/SettingsIcon.jsx
    frontend/src/components/Layout/icons/DownloadIcon.jsx
    frontend/src/components/Layout/icons/index.js
  </files>
  <action>
    Create 7 new icon components and a barrel export file. Each icon should be a functional React component returning an SVG with Lucide-style icons (24x24 viewBox, strokeWidth=2, currentColor stroke).

    Icons needed:
    - CubeIcon: 3D cube/box shape for 3D modeling category
    - BuildingIcon: Building/structure shape for structural category
    - DoorIcon: Door with frame for building elements category
    - TextIcon: "T" letter or text box for annotations category
    - EditIcon: Pencil/edit symbol for modify category
    - SettingsIcon: Gear/cog for manage category
    - DownloadIcon: Down arrow into tray for export category

    Fix PencilIcon.jsx which has corrupted SVG content (too long path data).

    Create index.js barrel export:
    ```javascript
    export { default as PencilIcon } from './PencilIcon'
    export { default as CubeIcon } from './CubeIcon'
    export { default as BuildingIcon } from './BuildingIcon'
    export { default as DoorIcon } from './DoorIcon'
    export { default as TextIcon } from './TextIcon'
    export { default as EditIcon } from './EditIcon'
    export { default as SettingsIcon } from './SettingsIcon'
    export { default as DownloadIcon } from './DownloadIcon'
    ```

    Icon SVG specifications:
    - viewBox="0 0 24 24"
    - fill="none"
    - stroke="currentColor"
    - strokeWidth={2}
    - strokeLinecap="round"
    - strokeLinejoin="round"
    - className="w-5 h-5" (or accept className prop)
  </action>
  <verify>
    - All icon files exist in frontend/src/components/Layout/icons/
    - index.js exports all 8 icons
    - Each icon component renders without errors
    - Icons follow consistent SVG structure
  </verify>
  <done>
    8 icon components created and properly exported from index.js
  </done>
</task>

<task type="auto">
  <name>Create layout sub-components</name>
  <files>
    frontend/src/components/Layout/BIMHeader.jsx
    frontend/src/components/Layout/BIMStatusBar.jsx
    frontend/src/components/Layout/QuickActions.jsx
  </files>
  <action>
    Create three layout sub-components to modularize BIMLayout.jsx:

    1. BIMHeader.jsx:
       - Props: onUndo, onRedo, canUndo, canRedo, viewMode, onViewModeChange, projectName
       - Contains: Undo/Redo buttons, view mode selector (perspective/top/front/side), project name display
       - Style: Dark theme matching Savage Cabinetry design (bg-savage-surface, border-slate-700)
       - Height: 48px (h-12)

    2. BIMStatusBar.jsx:
       - Props: activeTool, coordinates (x, y, z), zoom, snapEnabled, snapToGrid, snapToObjects
       - Contains: Active tool name, coordinate display (X: 0.00 Y: 0.00 Z: 0.00), zoom percentage, snap toggles
       - Style: Fixed at bottom, dark theme
       - Height: 32px (h-8)

    3. QuickActions.jsx:
       - Props: onNewProject, onSave, onExport, projectModified
       - Contains: "New Project" button (primary), "Save" button (secondary), "Export" button (outline)
       - Uses icons from icons/index.js
       - Style: Vertical stack of buttons in sidebar

    All components should use Tailwind classes and follow existing Savage Cabinetry styling:
    - bg-savage-dark, bg-savage-surface
    - text-savage-text, text-savage-text-muted
    - border-slate-700
    - btn, btn-primary, btn-secondary, btn-outline classes
  </action>
  <verify>
    - BIMHeader.jsx exports working component with all props
    - BIMStatusBar.jsx exports working component with coordinate display
    - QuickActions.jsx exports working component with all three buttons
    - Components use Tailwind styling consistent with existing codebase
  </verify>
  <done>
    All three sub-components created and ready for integration
  </done>
</task>

<task type="auto">
  <name>Update BIMLayout.jsx integration</name>
  <files>frontend/src/components/Layout/BIMLayout.jsx</files>
  <action>
    Update BIMLayout.jsx to:

    1. Import all icon components from the barrel export:
       ```javascript
       import {
         PencilIcon, CubeIcon, BuildingIcon, DoorIcon,
         TextIcon, EditIcon, SettingsIcon, DownloadIcon
       } from './icons'
       ```

    2. Import new sub-components:
       ```javascript
       import BIMHeader from './BIMHeader'
       import BIMStatusBar from './BIMStatusBar'
       import QuickActions from './QuickActions'
       ```

    3. Fix the createProject reference on line 258:
       - Add createProject to the destructured imports from useBIMStore:
         ```javascript
         const { 
           setActiveTool, 
           objects,
           selectedObjectIds, 
           undo, 
           redo, 
           project,
           saveProject,
           createProject,  // <-- ADD THIS
         } = useBIMStore()
         ```

    4. Integrate new components:
       - Add BIMHeader at the top of main content area (before Outlet)
       - Add BIMStatusBar at the bottom of main content area
       - Replace the inline Quick Actions section with QuickActions component

    5. Remove the aliased imports (LineIcon, PolylineIcon, etc.) since they reference PencilIcon:
       - Remove: `import { PencilIcon as LineIcon, ... } from './icons'`
       - Update toolsByCategory to use PencilIcon directly or create more specific icons later

    6. Ensure all references to createProject work correctly:
       - QuickActions onNewProject prop should call createProject
       - Pass appropriate props to BIMHeader (undo, redo, canUndo, canRedo)
       - Pass appropriate props to BIMStatusBar (activeTool, coordinates, zoom)
  </action>
  <verify>
    - BIMLayout.jsx imports all icons from './icons'
    - createProject is destructured from useBIMStore
    - BIMHeader, BIMStatusBar, and QuickActions are imported and used
    - No reference errors in console
    - Layout renders without crashing
  </verify>
  <done>
    BIMLayout.jsx fully integrated with all icons and sub-components
  </done>
</task>

</tasks>

<verification>
1. All 8 icon components exist and render correctly
2. Icons barrel export works and is used by BIMLayout
3. BIMHeader, BIMStatusBar, QuickActions components exist
4. BIMLayout.jsx imports work correctly
5. createProject is properly wired from useBIMStore
6. No console errors or reference errors
</verification>

<success_criteria>
- [ ] All icon files created in frontend/src/components/Layout/icons/
- [ ] index.js barrel export created and exports all icons
- [ ] PencilIcon.jsx SVG content is fixed
- [ ] BIMHeader.jsx created with proper props interface
- [ ] BIMStatusBar.jsx created with coordinate display
- [ ] QuickActions.jsx created with New, Save, Export buttons
- [ ] BIMLayout.jsx imports all icons from barrel export
- [ ] BIMLayout.jsx imports and uses BIMHeader, BIMStatusBar, QuickActions
- [ ] createProject destructured from useBIMStore in BIMLayout
- [ ] No undefined function references
- [ ] Layout renders without errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-bim-workbench/06-01-SUMMARY.md` with:
- List of created files
- Component API documentation for BIMHeader, BIMStatusBar, QuickActions
- Notes on icon usage patterns
</output>
